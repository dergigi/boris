import { normalizeToSecretKey } from "applesauce-core/helpers";
import { finalizeEvent, generateSecretKey, getPublicKey, nip04, nip44 } from "nostr-tools";
/** A Simple NIP-07 signer class */
export class SimpleSigner {
    key;
    constructor(key) {
        this.key = key || generateSecretKey();
    }
    async getPublicKey() {
        return getPublicKey(this.key);
    }
    async signEvent(event) {
        return finalizeEvent(event, this.key);
    }
    nip04 = {
        encrypt: async (pubkey, plaintext) => nip04.encrypt(this.key, pubkey, plaintext),
        decrypt: async (pubkey, ciphertext) => nip04.decrypt(this.key, pubkey, ciphertext),
    };
    nip44 = {
        encrypt: async (pubkey, plaintext) => nip44.v2.encrypt(plaintext, nip44.v2.utils.getConversationKey(this.key, pubkey)),
        decrypt: async (pubkey, ciphertext) => nip44.v2.decrypt(ciphertext, nip44.v2.utils.getConversationKey(this.key, pubkey)),
    };
    /** Creates a SimpleSigner from a hex private key or NIP-19 nsec */
    static fromKey(privateKey) {
        return new SimpleSigner(normalizeToSecretKey(privateKey));
    }
}
